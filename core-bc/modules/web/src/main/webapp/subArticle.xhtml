<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:jsf="http://xmlns.jcp.org/jsf"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:o="http://omnifaces.org/ui"
      xmlns:p="http://xmlns.jcp.org/jsf/passthrough"
      xmlns:c="http://java.sun.com/jsp/jstl/core">

<ui:composition template="WEB-INF/xhtml/template/wideContent.xhtml">

    <ui:define name="currentPage">Underartiklar</ui:define>

    <ui:define name="boxContent">
        <script src="https://unpkg.com/vue@2.1.10/dist/vue.js" crossorigin="anonymous"></script>

        <h:outputStylesheet>
            /* IE 11 */
            @media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
                span input[type=range] {
                    top: 10px;
                }

                .circle-icon.plus .circle-icon-content {
                    top: 3px;
                }
            }

            /* IE Edge */
            @supports (-ms-accelerator:true) {
                span input[type=range] {
                    top: 6px;
                }

                .circle-icon.plus .circle-icon-content {
                    top: 3px;
                }
            }
        </h:outputStylesheet>

        <h:outputStylesheet>
            [v-cloak] {
                display: none;
            }
        </h:outputStylesheet>

        <h:outputStylesheet>
            .sub-articles-table {
                margin-bottom: 24px;
            }

            .sub-articles-table td {
                padding: 4px 8px;
            }

            .sub-articles-table input[type="text"] {
                text-align: center;
            }

            .sub-articles-table h3 {
                margin-top: 18px;
            }

            .sub-article-name {
                display: inline-block;
                width: 400px;
            }

            .sub-article-row {
                height: 36px;
                margin-bottom: 8px;
            }

            .circle-icon {
                display: inline-block;
                width: 32px;
                height: 32px;
                background: #008391;
                border-radius: 50%;
                border: 1px solid #008391;
                text-align: center;
                color: #fff;
                font-size: 2em;
                line-height: 26px;
                position: relative;
                top: 2px;
                margin: 0 8px;
                font-family: sans-serif;
                font-weight: bold;
                position: relative;
            }

            .circle-icon .circle-icon-content {
                position: relative;
                top: 1px;
            }

            .circle-icon:hover {
                cursor: pointer;
                background: #ffffff;
                color: #008391;
            }

            span.circle-icon.minus {
                /*line-height: 28px;*/
                margin-left: 24px;
            }

            .range-wrapper {
                display: inline-block;
                height: 36px;
                position: relative;
                width: 200px;
            }

            input[type=range] {
                -webkit-appearance: none; /* Hides the slider so that custom slider can be made */
                width: 100%; /* Specific width is required for Firefox. */
                background: transparent; /* Otherwise white in Chrome */

                width: 200px;
                padding: 0;

                position: absolute;
                top: 28px;
            }

            input[type=range]::-webkit-slider-thumb {
                -webkit-appearance: none;
            }

            input[type=range]:focus {
                outline: none; /* Removes the blue border. You should probably do some kind of focus styling for accessibility reasons though. */
            }

            input[type=range]::-ms-track {
                width: 100%;
                cursor: pointer;

                /* Hides the slider so custom styles can be added */
                background: transparent;
                border-color: transparent;
                color: transparent;
            }

            /* Special styling for WebKit/Blink */
            input[type=range]::-webkit-slider-thumb {
                -webkit-appearance: none;
                /*border: 1px solid #000000;*/
                height: 28px;
                width: 28px;
                border: 1px solid #008391;
                border-radius: 50%;
                background: #008391;
                cursor: pointer;
                margin-top: -10px; /* You need to specify a margin in Chrome, but in Firefox and IE it is automatic */
                /*box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d; !* Add cool effects to your sliders! *!*/
            }

            input[type=range]::-webkit-slider-thumb:hover {
                background: #ffffff;
            }

            /* All the same stuff for Firefox */
            input[type=range]::-moz-range-thumb {
                /*box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;*/
                border: 1px solid #008391;
                height: 28px;
                width: 28px;
                border-radius: 50%;
                background: #008391;
                cursor: pointer;
            }

            input[type=range]::-moz-range-thumb:hover {
                background: #ffffff;
            }

            /* All the same stuff for IE */
            input[type=range]::-ms-thumb {
                /*box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;*/
                /*border: 1px solid #000000;*/
                border: 1px solid #008391;
                height: 28px;
                width: 28px;
                border-radius: 50%;
                /*background: #ffffff;*/
                background: #008391;
                cursor: pointer;

                margin-top: 0;
            }

            input[type=range]::-ms-thumb:hover {
                /*box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;*/
                background: #ffffff;
            }

            input[type=range]::-webkit-slider-runnable-track {
                width: 100%;
                height: 8.4px;
                cursor: pointer;
                /*box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;*/
                background: #e3e3e3;
                /*background: #3071a9;*/
                border-radius: 3px;
                /*border: 0.2px solid #010101;*/
            }

            input[type=range]:focus::-webkit-slider-runnable-track {
                /*background: #367ebd;*/
            }

            input[type=range]::-moz-range-track {
                width: 100%;
                height: 8.4px;
                cursor: pointer;
                /*box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;*/
                background: #e3e3e3;
                /*background: #3071a9;*/
                border-radius: 3px;
                /*border: 0.2px solid #010101;*/
            }

            input[type=range]::-ms-track {
                width: 100%;
                height: 8.4px;
                cursor: pointer;
                background: transparent;
                border-color: transparent;
                border-width: 16px 0;
                color: transparent;
            }

            input[type=range]::-ms-fill-lower {
                background: #e3e3e3;
                /*border: 0.2px solid #010101;*/
                border-radius: 3px 0 0 3px;
                /*box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;*/
            }

            input[type=range]:focus::-ms-fill-lower {
                background: #e3e3e3;
                /*background: #3071a9;*/
            }

            input[type=range]::-ms-fill-upper {
                background: #e3e3e3;
                /*background: #3071a9;*/
                /*border: 0.2px solid #010101;*/
                border-radius: 0 3px 3px 0;
                /*box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;*/
            }

            input[type=range]:focus::-ms-fill-upper {
                /*background: #367ebd;*/
            }
        </h:outputStylesheet>

        <o:messages showSummary="true" styleClass="alert alert-danger" escape="false"/>

        <div>
            <h3>Fördela underartiklar</h3>
            <div class="page-introduction">
                <div>
                    <p>
                        Du har valt produkter där du behöver göra ytterligare val. Dra i reglagen eller ange antal för att ändra fördelningen.
                    </p>
                </div>
            </div>

            <h:form>
                <div id="app" v-cloak="">
                    <ui:repeat value="#{subArticleController.prescriptionItems}" var="prescriptionItem"
                               varStatus="parentArticleStatus">
                        <h2>#{prescriptionItem.parentArticleName}</h2>
                        <!--<div>-->
                            <!--<table id="subArticlesTable">-->
                            <div class="sub-articles-table">
                            <!--<ul>-->
                                <ui:repeat value="#{prescriptionItem.subArticles}" var="subArticle"
                                           varStatus="subArticleStatus">
                                    <div class="sub-article-row">
                                        <!--#{subArticle.name}:-->
                                        <span class="sub-article-name"><h:inputText style="display: none" id="jsfInputRepeated"
                                                     styleClass="jsf-input-#{parentArticleStatus.index}-#{subArticleStatus.index}"
                                                     value="#{subArticle.orderCount}"/>
                                            {{jsonData[#{parentArticleStatus.index}].subArticles[#{subArticleStatus.index}].name}}
                                        </span>
                                        <span class="range-wrapper">
                                            <input type="range" step="1" min="0"
                                                   max="#{prescriptionItem.totalOrderSize}" v-if="seen"
                                                   v-model="jsonData[#{parentArticleStatus.index}].subArticles[#{subArticleStatus.index}].orderCount"/>
                                        </span>
                                        <span>
                                            <span class="circle-icon minus" data-parent-article-index="#{parentArticleStatus.index}" data-sub-article-index="#{subArticleStatus.index}"><span class="circle-icon-content">&#8211;</span></span>
                                            <input type="text" class="short-number-input"
                                                   v-model="jsonData[#{parentArticleStatus.index}].subArticles[#{subArticleStatus.index}].orderCount" tabindex="1#{parentArticleStatus.index}#{subArticleStatus.index}"/>
                                            <span class="circle-icon plus" data-parent-article-index="#{parentArticleStatus.index}" data-sub-article-index="#{subArticleStatus.index}"><span class="circle-icon-content">+</span></span>
                                        </span>
                                    </div>
                                </ui:repeat>
                                <h3>Totalt antal förpackningar: {{jsonData[#{parentArticleStatus.index}].totalOrderSize}} st</h3>

                            </div>
                    </ui:repeat>

                    <div class="right-align">
                        <h:commandButton styleClass="button back-button full-page-submit" value="Bakåt" action="#{subArticleController.toOrder}" />
                        <h:commandButton styleClass="button full-page-submit" value="Till leverans" action="#{subArticleController.toDelivery}" />
                    </div>
                </div>

                <script>

                    var app = new Vue({
                        el: '#app',
                        data: {
                            myData: 'Hello Vue!',
                            seen: true,
                            jsonData: #{subArticleController.jsonData}
                        }
                    });

                </script>

                <script type="text/javascript" src="javax.faces.resource/js/sub-articles.js.xhtml?ln=default&amp;v=1_0"></script>

            </h:form>
        </div>
    </ui:define>

</ui:composition>
</html>
